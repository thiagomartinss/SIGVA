<script src="/js/ordemServico/criarOs.js"></script>
<link rel="stylesheet" href="/css/ordemServico/ordemServico.css">
<div class="d-flex">
    <aside class="sidebar d-flex flex-column">
        <ul class="nav flex-column flex-grow-1">
            <li class="nav-item">
                <a class="nav-link" href="../admin"><i class="fa-solid fa-house fa-fw"></i> Home</a>
            </li>
            <li class="nav-item">
                <a class="nav-link active" href="#"><i class="fa-solid fa-clipboard-list fa-fw"></i>Criar OS</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/ordemServico/listar"><i class="fa-solid fa-clipboard-list fa-fw"></i>Listar OS</a>
            </li>
            <li class="nav-item">
                <a class="nav-link " href="/produto"><i class="fa-solid fa-boxes-stacked fa-fw"></i>Produtos</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="../servico"><i class="fa-solid fa-list fa-fw"></i> Serviços</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="../equipamento"><i class="fa-solid fa-wrench fa-fw"></i> Equipamentos</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="../marca"><i class="fa-solid fa-tags fa-fw"></i> Marcas</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="../pessoa"><i class="fa-solid fa-user fa-fw"></i> Pessoas</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="../funcionario"><i class="fa-solid fa-user fa-fw"></i> Funcionários</a>
            </li>
             <li class="nav-item">
                <a class="nav-link" href="/relatorio"><i class="fa-solid fa-folder-open fa-fw"></i> Relatorios</a>
            </li>
            <hr />
            <li class="nav-item">
                <a class="nav-link" href="../login/logout"><i class="fa-solid fa-power-off fa-fw"></i> Sair</a>
            </li>
        </ul>
    </aside>
    <div class="container my-5">
        <div class="card shadow-sm">
            <div class="card-header bg-white py-3">
                <h2 class="text-uppercase text-green100 mb-0"><i class="fa-solid fa-clipboard-list me-2"></i>Nova Ordem de Serviço</h2>
            </div>
            <div class="card-body p-4">
                <form id="formOS">
                    <input type="hidden" id="clienteId" name="clienteId">
                    <input type="hidden" id="clienteEnderecoId" name="clienteEnderecoId">
                    <h5 class="text-secondary mb-3 border-bottom pb-2">Dados do Cliente</h5>
                    <div class="row mb-3">
                        <div class="col-12">
                            <div class="input-group">
                                <div class="form-floating">
                                    <input type="text" class="form-control" id="clienteNome" placeholder="Selecione o cliente" readonly> 
                                    <label for="clienteNome">Cliente</label>
                                </div>
                                <button class="btn btn-search bg-green200" type="button" data-bs-toggle="modal" data-bs-target="#modalBuscaCliente">
                                    <i class="fa-solid fa-magnifying-glass"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="row g-2 mb-3">
                        <div class="col-md-2">
                            <div class="form-floating">
                                <input type="text" class="form-control" id="clienteCep" placeholder="CEP" readonly>
                                <label for="clienteCep">CEP</label>
                            </div>
                        </div>
                        <div class="col-md-8">
                            <div class="form-floating">
                                <input type="text" class="form-control" id="clienteLogradouro" placeholder="Logradouro" readonly>
                                <label for="clienteLogradouro">Logradouro</label>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="form-floating">
                                <input type="text" class="form-control" id="clienteNumero" placeholder="Número" readonly>
                                <label for="clienteNumero">Número</label>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-floating">
                                <input type="text" class="form-control" id="clienteBairro" placeholder="Bairro" readonly>
                                <label for="clienteBairro">Bairro</label>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-floating">
                                <input type="text" class="form-control" id="clienteCidade" placeholder="Cidade" readonly>
                                <label for="clienteCidade">Cidade</label>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="form-floating">
                                <input type="text" class="form-control" id="clienteEstado" placeholder="UF" readonly>
                                <label for="clienteEstado">Estado</label>
                            </div>
                        </div>
                    </div>
                    <h5 class="text-secondary mb-3 border-bottom pb-2 mt-4">Descrição Geral</h5>
                    <div class="row mb-3">
                        <div class="col-12">
                            <div class="form-floating">
                                <textarea class="form-control text-uppercase" placeholder="Descreva o serviço a ser realizado" id="descServico" name="descServico" style="height: 100px" required></textarea>
                                <label for="descServico">Descrição do serviço a realizar</label>
                            </div>
                        </div>
                    </div>
                    <h5 class="text-secondary mb-3 border-bottom pb-2 mt-4">Serviços</h5>
                    <div class="row g-2 mb-3">
                        <input type="hidden" id="servicoIdSelecionado">
                        <div class="col-md-8">
                            <div class="input-group">
                                <div class="form-floating">
                                    <input type="text" class="form-control" id="servicoNome" placeholder="Buscar Serviço" readonly>
                                    <label for="servicoNome">Serviço a ser realizado</label>
                                </div>
                                <button class="btn btn-search" type="button" data-bs-toggle="modal" data-bs-target="#modalBuscaServico">
                                    <i class="fa-solid fa-magnifying-glass"></i>
                                </button>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-floating">
                                <input type="text" class="form-control" id="servicoValor" placeholder="Valor">
                                <label for="servicoValor">Valor (R$)</label>
                            </div>
                        </div>
                        <div class="col-md-1">
                            <button type="button" class="btn btn-success bg-green200 w-100 py-3" id="btnAdicionarServico" title="Adicionar Serviço na Lista">
                                <i class="fa-solid fa-plus"></i>
                            </button>
                        </div>
                    </div>
                    <div class="table-responsive mb-4">
                        <table class="table table-striped table-bordered">
                            <thead class="table-light">
                                <tr>
                                    <th>Descrição do Serviço</th>
                                    <th width="150px">Valor (R$)</th>
                                    <th width="100px" class="text-center">Ação</th>
                                </tr>
                            </thead>
                            <tbody id="listaServicosAdicionados">
                                </tbody>
                        </table>
                    </div>
                    <h5 class="text-secondary mb-3 border-bottom pb-2 mt-4">Equipamento usado no serviço</h5>
                    <input type="hidden" id="equipamentoIdSelecionado">
                    <div class="row g-2 mb-3">
                        <div class="col-md-10">
                            <div class="input-group">
                                <div class="form-floating">
                                    <input type="text" class="form-control" id="equipamentoNome" placeholder="Equipamento" readonly>
                                    <label for="equipamentoNome">Equipamento selecionado</label>
                                </div>
                                <button class="btn btn-search" type="button" data-bs-toggle="modal" data-bs-target="#modalBuscaEquipamento">
                                    <i class="fa-solid fa-magnifying-glass"></i>
                                </button>
                            </div>
                        </div> 
                        <div class="col-md-2">
                            <div class="form-floating">
                                <input type="number" class="form-control" id="equipamentoQtd" name="equipamentoQtd" placeholder="Qtd" value="1" min="1" max="1" readonly>
                                <label for="equipamentoQtd">Quantidade</label>
                            </div>
                        </div>
                    </div>
                    <h5 class="text-secondary mb-3 border-bottom pb-2 mt-4">Produtos Utilizados</h5>
                    <input type="hidden" id="produtoIdSelecionado">
                    <div class="row g-2 mb-3 align-items-center">
                        <div class="col-md-7    ">
                            <div class="input-group">
                                <div class="form-floating">
                                    <input type="text" class="form-control" id="produtoNome" placeholder="Produto" readonly>
                                    <label for="produtoNome">Produto</label>
                                </div>
                                <button class="btn btn-search" type="button" data-bs-toggle="modal" data-bs-target="#modalBuscaProduto">
                                    <i class="fa-solid fa-magnifying-glass"></i>
                                </button>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="form-floating">
                                <input type="text" class="form-control" id="produtoValor" placeholder="Valor Un.">
                                <label for="produtoValor">Valor Unit. (R$)</label>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="form-floating">
                                <input type="number" class="form-control" id="produtoQtd" placeholder="Qtd">
                                <label for="produtoQtd">Quantidade</label>
                            </div>
                        </div>
                        <div class="col-md-1">
                            <button type="button" class="btn btn-success bg-green200 w-100 py-3" id="btnAdicionarProduto" title="Adicionar Produto">
                                <i class="fa-solid fa-plus"></i>
                            </button>
                        </div>
                    </div>
                    <div class="table-responsive mb-4">
                        <table class="table table-striped table-bordered">
                            <thead class="table-light">
                                <tr>
                                    <th>Produto</th>
                                    <th width="150px">Valor Unit.</th>
                                    <th width="100px" class="text-center">Qtd</th>
                                    <th width="150px">Subtotal</th>
                                    <th width="100px" class="text-center">Ação</th>
                                </tr>
                            </thead>
                            <tbody id="listaProdutosAdicionados">
                                </tbody>
                        </table>
                    </div>
                    <div class="row justify-content-end my-3">
                    <div class="col-md-4">
                        <div class="card bg-light border-success">
                            <div class="card-body d-flex justify-content-between align-items-center">
                                <h5 class="mb-0 text-success fw-bold">VALOR TOTAL:</h5>
                                <h4 class="mb-0 text-success fw-bold" id="labelValorTotal">R$ 0.00</h4>
                            </div>
                        </div>
                    </div>
                </div>
                <hr class="my-4">
                <div class="d-flex justify-content-end gap-2">
                    <hr class="my-4">
                    <div class="d-flex justify-content-end gap-2">
                        <button type="button" class="btn btn-secondary btn-lg" id="btnCancelar">
                            <i class="fa-solid fa-xmark me-2"></i>Cancelar
                        </button>
                        <button type="submit" class="btn btn-success bg-green200 btn-lg">
                            <i class="fa-solid fa-check me-2"></i>Gerar Ordem de Serviço
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div class="modal fade" id="modalBuscaCliente" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Pesquisar Cliente</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="input-group mb-3">
                        <input type="text" class="form-control text-uppercase" id="termoBuscaCliente" placeholder="Digite o nome ou nome fantasia...">
                        <button class="btn btn-success bg-green200" type="button" id="btnFiltrarCliente">
                            <i class="fa-solid fa-search"></i> Buscar
                        </button>
                    </div>
                    
                    <div class="table-responsive">
                        <table class="table table-hover table-bordered">
                            <thead class="table-light">
                                <tr>
                                    <th>Nome / Fantasia</th>
                                    <th>CPF / CNPJ</th>
                                    <th>Cidade/UF</th>
                                    <th class="text-center">Ação</th>
                                </tr>
                            </thead>
                            <tbody id="listaClientesResultados">

                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
   <div class="modal fade" id="modalBuscaServico" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Pesquisar Serviço</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="input-group mb-3">
                        <input type="text" class="form-control text-uppercase" id="termoBuscaServico" placeholder="Digite o nome do serviço...">
                        <button class="btn btn-success bg-green200" type="button" id="btnFiltrarServico">
                            <i class="fa-solid fa-search"></i> Buscar
                        </button>
                    </div>
                    
                    <div class="table-responsive">
                        <table class="table table-hover table-bordered">
                            <thead class="table-light">
                                <tr>
                                    <th>ID</th>
                                    <th>Descrição</th>
                                    <th>Valor Padrão</th>
                                    <th class="text-center">Ação</th>
                                </tr>
                            </thead>
                            <tbody id="listaServicosResultados">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="modalBuscaEquipamento" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Pesquisar Equipamento</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="input-group mb-3">
                        <input type="text" class="form-control text-uppercase" id="termoBuscaEquipamento" placeholder="Digite o nome ou modelo...">
                        <button class="btn btn-success bg-green200" type="button" id="btnFiltrarEquipamento">
                            <i class="fa-solid fa-search"></i> Buscar
                        </button>
                    </div>
                    <div class="table-responsive">
                        <table class="table table-hover table-bordered">
                            <thead class="table-light">
                                <tr>
                                    <th>Equipamento</th>
                                    <th>Modelo</th>
                                    <th>Estoque</th>
                                    <th class="text-center">Ação</th>
                                </tr>
                            </thead>
                            <tbody id="listaEquipamentosResultados">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="modalBuscaProduto" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Pesquisar Produto</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="input-group mb-3">
                        <input type="text" class="form-control" id="termoBuscaProduto" placeholder="Digite o nome do produto...">
                        <button class="btn btn-success bg-green200" type="button" id="btnFiltrarProduto">
                            <i class="fa-solid fa-search"></i> Buscar
                        </button>
                    </div>
                    <div class="table-responsive">
                        <table class="table table-hover table-bordered">
                            <thead class="table-light">
                                <tr>
                                    <th>Produto</th>
                                    <th>Valor Venda</th>
                                    <th class="text-center">Ação</th>
                                </tr>
                            </thead>
                            <tbody id="listaProdutosResultados"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>